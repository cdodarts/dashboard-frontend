import{_ as F}from"./ConnectionStatus-BNvYJzZm.js";import{_ as P,V as E,a as I,b as R}from"./VContainer-CoJXfR-4.js";import{o as j,a as H,c as N,g as Y,b as X,r as i,u as q,d as u,w as r,e as a,f as s,h as p,V as z,t as n,F as G,i as J,j as K,k as Q,l as c,n as W,m as Z,p as m}from"./index-BsA5uyE-.js";import{V as $}from"./VAlert-D9RsTQJv.js";import{V as h}from"./VChip-GHPtzN8R.js";import{V as ee,a as te}from"./VRow-CMnZ5MN3.js";const ae={class:"d-flex flex-column flex-sm-row justify-space-between align-start align-sm-center mb-6 gap-3"},re={key:0,class:"text-center py-16"},se={class:"text-body-2"},oe={key:0,class:"text-caption text-secondary mt-2"},ne={key:2,class:"d-flex flex-column ga-4"},le={class:"text-h5 text-primary-high font-weight-bold"},ie={class:"text-body-2 text-secondary"},ue={class:"d-flex ga-2 flex-wrap"},ce={class:"d-flex justify-space-between align-center mb-2"},de={class:"text-center mt-2"},me={class:"text-caption text-secondary"},ve=60,pe=70,fe=80,Ve={__name:"index",setup(he){const{error:A}=q(),y=i(!1),f=i(null),g=i(!0),o=i(null),x=i(""),w=i(""),l=i(null);let _=null;const M=m(()=>{if(!l.value)return[];const e=[];return l.value.code&&e.push(`Code: ${l.value.code}`),l.value.status&&e.push(`Status: ${l.value.status}`),l.value.requestUrl&&e.push(`URL: ${l.value.requestUrl}`),e}),T=m(()=>Math.round(Number(o.value?.cpu?.usage_percent??o.value?.cpu?.usage??0))),k=m(()=>Math.round(Number(o.value?.memory?.percent??o.value?.memory?.percent_used??0))),D=m(()=>Math.round(Number(o.value?.disk?.percent??o.value?.disk?.percent_used??0))),d=m(()=>Number(o.value?.temperature?.celsius??o.value?.temperature?.temp_c??0)),v=m(()=>d.value>=fe?{color:"error",alertType:"error",message:"Your CDO Vertex is running hot. Temperature is in the critical range; the system may throttle to prevent damage."}:d.value>=pe?{color:"warning",alertType:"warning",message:"Your CDO Vertex is above the ideal 70°C. Ensure it is not in direct sunlight and the vent has room for airflow."}:d.value>=ve?{color:"info",alertType:"info",message:"Your CDO Vertex is operating in normal temperatures under typical use."}:{color:"success",alertType:"success",message:"Your CDO Vertex is operating in normal temperatures."});function U(e){return e>=90?"error":e>=70?"warning":"success"}function L(e){return e>=95?"error":e>=85?"warning":"success"}function O(e){const t=Number(e||0),C=Math.floor(t/86400),V=Math.floor(t%86400/3600),B=Math.floor(t%3600/60);return`${C}d ${V}h ${B}m`}async function b(){try{y.value=!0,f.value=null;const e=await X();o.value=e.data,g.value=!0,w.value=new Date().toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit"})}catch(e){f.value=e.message,l.value=e,g.value=!1,A("Failed to fetch dashboard data: "+e.message)}finally{y.value=!1}}async function S(){try{const e=await Y();x.value=e.data?.version||""}catch{x.value=""}}return j(async()=>{await S(),await b(),_=setInterval(b,5e3)}),H(()=>{_&&clearInterval(_)}),(e,t)=>(u(),N(R,{class:"pa-4 pa-md-6",fluid:""},{default:r(()=>[a("div",ae,[t[0]||(t[0]=a("div",null,[a("h1",{class:"text-h4 text-md-h3 text-primary-high font-weight-bold mb-1"},"Dashboard"),a("p",{class:"text-body-2 text-secondary"},"At-a-glance device health")],-1)),s(F,{connected:g.value},null,8,["connected"])]),y.value&&!o.value?(u(),p("div",re,[s(z,{color:"primary",indeterminate:"",size:"64"}),t[1]||(t[1]=a("div",{class:"text-body-1 text-secondary mt-4"},"Loading dashboard...",-1))])):f.value?(u(),N($,{key:1,class:"mb-6",icon:"mdi-alert-circle",prominent:"",type:"error",variant:"tonal"},{append:r(()=>[s(Q,{color:"error",variant:"outlined",onClick:b},{default:r(()=>[...t[2]||(t[2]=[c("Retry",-1)])]),_:1})]),default:r(()=>[t[3]||(t[3]=a("div",{class:"text-h6 mb-2"},"Connection Error",-1)),a("div",se,n(f.value),1),M.value.length?(u(),p("div",oe,[(u(!0),p(G,null,J(M.value,(C,V)=>(u(),p("div",{key:V},n(C),1))),128))])):K("",!0)]),_:1})):(u(),p("div",ne,[s(P,{elevated:""},{default:r(()=>[s(E,{class:"d-flex flex-column flex-md-row justify-space-between align-start align-md-center ga-4"},{default:r(()=>[a("div",null,[t[4]||(t[4]=a("div",{class:"text-overline text-secondary"},"Device summary",-1)),a("div",le,n(o.value?.hostname?.hostname||"CDO Vertex"),1),a("div",ie," Uptime "+n(O(o.value?.uptime?.uptime_seconds||0))+" · API "+n(x.value||"n/a"),1)]),a("div",ue,[s(h,{color:U(T.value),"prepend-icon":"mdi-chip",variant:"tonal"},{default:r(()=>[c(n(T.value)+"% CPU",1)]),_:1},8,["color"]),s(h,{color:L(k.value),"prepend-icon":"mdi-memory",variant:"tonal"},{default:r(()=>[c(n(k.value)+"% Memory",1)]),_:1},8,["color"]),s(h,{color:U(D.value),"prepend-icon":"mdi-harddisk",variant:"tonal"},{default:r(()=>[c(n(D.value)+"% Disk",1)]),_:1},8,["color"]),s(h,{color:v.value.color,"prepend-icon":"mdi-thermometer",variant:"tonal"},{default:r(()=>[c(n(d.value.toFixed(1))+"°C",1)]),_:1},8,["color"])])]),_:1})]),_:1}),s(ee,null,{default:r(()=>[s(te,{cols:"12",lg:"12",md:"12"},{default:r(()=>[s(P,{class:"h-100 hoverable-card"},{default:r(()=>[s(I,{class:"text-primary-high"},{default:r(()=>[...t[5]||(t[5]=[c("Temperature",-1)])]),_:1}),s(E,null,{default:r(()=>[a("div",ce,[t[6]||(t[6]=a("span",{class:"text-body-2 text-secondary"},"CPU Temperature",-1)),a("span",{class:W(["text-h5",`text-${v.value.color}`])},n(d.value.toFixed(1))+"°C",3)]),s(Z,{color:v.value.color,height:"12","model-value":Math.min(Math.max(d.value,0),100),rounded:""},null,8,["color","model-value"]),s($,{class:"mt-3",density:"comfortable",type:v.value.alertType,variant:"tonal"},{default:r(()=>[c(n(v.value.message),1)]),_:1},8,["type"])]),_:1})]),_:1})]),_:1})]),_:1}),a("div",de,[a("div",me,"Last updated: "+n(w.value),1)])]))]),_:1}))}};export{Ve as default};
