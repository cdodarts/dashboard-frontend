import{b as oe,_ as U,a as B,V as I}from"./VContainer-CoJXfR-4.js";import{B as de,C as q,S as ue,T as re,D as ce,E as me,G as fe,f as t,H as G,I as ve,U as X,r as d,J as pe,e as n,R as Y,n as Z,W as ye,X as ge,A as b,Y as we,V as se,F as be,_ as he,Z as Ve,q as ke,o as _e,c as K,w as i,$ as xe,b as Se,a0 as Ce,u as Fe,d as P,h as O,l as c,a1 as Ne,k as x,t as Te,j as Q,p as ee,a2 as Ue,a3 as Ie,a4 as Pe}from"./index-BsA5uyE-.js";import{V as Ae,a as te}from"./VRow-CMnZ5MN3.js";import{u as Be,V as ae,e as le,f as We,b as De,d as Re,c as j}from"./VSelect-BYKTxo58.js";import{V as Me}from"./VAlert-D9RsTQJv.js";import"./VDivider-UUIsAQ6U.js";import"./VChip-GHPtzN8R.js";const ze=pe({indeterminate:Boolean,inset:Boolean,flat:Boolean,loading:{type:[Boolean,String],default:!1},...De(),...We()},"VSwitch"),W=de()({name:"VSwitch",inheritAttrs:!1,props:ze(),emits:{"update:focused":o=>!0,"update:modelValue":o=>!0,"update:indeterminate":o=>!0},setup(o,S){let{attrs:y,slots:u}=S;const f=q(o,"indeterminate"),m=q(o,"modelValue"),{loaderClasses:h}=ue(o),{isFocused:v,focus:C,blur:F}=Be(o),g=d(),V=d(),k=re&&window.matchMedia("(forced-colors: active)").matches,r=X(()=>typeof o.loading=="string"&&o.loading!==""?o.loading:o.color),l=ce(),D=X(()=>o.id||`switch-${l}`);function _(){f.value&&(f.value=!1)}function R(w){w.stopPropagation(),w.preventDefault(),g.value?.input?.click()}return me(()=>{const[w,A]=fe(y),M=ae.filterProps(o),z=le.filterProps(o);return t(ae,G({ref:V,class:["v-switch",{"v-switch--flat":o.flat},{"v-switch--inset":o.inset},{"v-switch--indeterminate":f.value},h.value,o.class]},w,M,{modelValue:m.value,"onUpdate:modelValue":N=>m.value=N,id:D.value,focused:v.value,style:o.style}),{...u,default:N=>{let{id:$,messagesId:a,isDisabled:e,isReadonly:s,isValid:J}=N;const E={model:m,isValid:J};return t(le,G({ref:g},z,{modelValue:m.value,"onUpdate:modelValue":[T=>m.value=T,_],id:$.value,"aria-describedby":a.value,type:"checkbox","aria-checked":f.value?"mixed":void 0,disabled:e.value,readonly:s.value,onFocus:C,onBlur:F},A),{...u,default:T=>{let{backgroundColorClasses:H,backgroundColorStyles:p}=T;return n("div",{class:Z(["v-switch__track",k?void 0:H.value]),style:Y(p.value),onClick:R},[u["track-true"]&&n("div",{key:"prepend",class:"v-switch__track-true"},[u["track-true"](E)]),u["track-false"]&&n("div",{key:"append",class:"v-switch__track-false"},[u["track-false"](E)])])},input:T=>{let{inputNode:H,icon:p,backgroundColorClasses:ie,backgroundColorStyles:ne}=T;return n(be,null,[H,n("div",{class:Z(["v-switch__thumb",{"v-switch__thumb--filled":p||o.loading},o.inset||k?void 0:ie.value]),style:Y(o.inset?void 0:ne.value)},[u.thumb?t(ye,{defaults:{VIcon:{icon:p,size:"x-small"}}},{default:()=>[u.thumb({...E,icon:p})]}):t(ge,null,{default:()=>[o.loading?t(we,{name:"v-switch",active:!0,color:J.value===!1?void 0:r.value},{default:L=>u.loader?u.loader(L):t(se,{active:L.isActive,color:L.color,indeterminate:!0,size:"16",width:"2"},null)}):p&&t(b,{key:String(p),icon:p,size:"x-small"},null)]})])])}})}})}),ve({},V)}}),$e={key:0,class:"text-center py-16"},Ee={key:1},He={class:"d-flex align-center justify-space-between mb-3 flex-wrap ga-2"},Le={class:"text-caption text-secondary"},Oe={class:"text-primary-high"},je={key:0},Je={class:"mb-6"},qe={class:"mb-6"},Ge={class:"d-flex flex-column flex-sm-row gap-3 justify-end"},Xe={__name:"settings",setup(o){const{success:S,error:y}=Fe(),u=Ve(),f=d(!1),m=d(!1),h=d(!1),v=d(null),C=d(!1),F=d(!1),g=d(!1),V=d("Not connected"),k=d([]),r=d({ssid:"",password:""}),l=d({auto_update:{enabled:!1,check_interval_hours:24,check_time:"03:00",auto_install:!1},notifications:{update_available:!0,installation_complete:!0},display:{theme:"dark",refresh_interval_seconds:5}}),D=ee(()=>k.value.map(a=>({title:`${a.ssid}${a.signal_percent===void 0?"":` (${a.signal_percent}%)`}`,value:a.ssid})));function _(a){const e=a==="light"?"light":"dark";u.change(e),localStorage.setItem("vertex-theme",e)}ke(()=>l.value.display.theme,a=>{_(a)});const R=ee(()=>v.value?JSON.stringify(v.value)!==JSON.stringify(l.value):!1);async function w(){try{const a=await Se();V.value=a.data?.wifi?.ssid||"Not connected"}catch{V.value="Unknown"}}async function A(){try{C.value=!0;const e=(await Ce()).data?.networks||[];k.value=e.map(s=>({ssid:s.ssid,signal_percent:s.signal_percent??s.signal??s.strength})).filter(s=>!!s.ssid)}catch(a){y("Failed to scan Wi-Fi networks: "+a.message),k.value=[]}finally{C.value=!1}}async function M(){try{F.value=!0,await Ue({ssid:r.value.ssid,password:r.value.password}),S(`Attempting to connect to ${r.value.ssid}`),r.value.password="",await w()}catch(a){y("Failed to connect to Wi-Fi: "+a.message)}finally{F.value=!1}}async function z(){try{f.value=!0;const a=await xe();v.value=a.data,l.value=structuredClone(a.data),l.value.display.refresh_interval_seconds=5,_(l.value.display.theme)}catch(a){y("Failed to load settings: "+a.message)}finally{f.value=!1}}async function N(){try{m.value=!0,l.value.display.refresh_interval_seconds=5;const a=await Pe(l.value);v.value=a.data.settings,l.value=structuredClone(a.data.settings),l.value.display.refresh_interval_seconds=5,_(l.value.display.theme),S("Settings saved successfully")}catch(a){y("Failed to save settings: "+a.message)}finally{m.value=!1}}async function $(){if(confirm("Are you sure you want to reset all settings to defaults?"))try{h.value=!0;const a=await Ie();v.value=a.data.settings,l.value=structuredClone(a.data.settings),l.value.display.refresh_interval_seconds=5,_(l.value.display.theme),S("Settings reset to defaults")}catch(a){y("Failed to reset settings: "+a.message)}finally{h.value=!1}}return _e(async()=>{await z(),await w(),await A()}),(a,e)=>(P(),K(oe,{class:"pa-4 pa-md-6",fluid:""},{default:i(()=>[e[28]||(e[28]=n("div",{class:"mb-6"},[n("h1",{class:"text-h4 text-md-h3 text-primary-high font-weight-bold mb-1"},"Settings"),n("p",{class:"text-body-2 text-secondary"},"Configure theme, notifications, Wi-Fi, and auto-update behavior")],-1)),f.value&&!v.value?(P(),O("div",$e,[t(se,{color:"primary",indeterminate:"",size:"64"}),e[10]||(e[10]=n("div",{class:"text-body-1 text-secondary mt-4"},"Loading settings...",-1))])):(P(),O("div",Ee,[t(Ae,null,{default:i(()=>[t(te,{cols:"12",lg:"6"},{default:i(()=>[t(U,{class:"mb-4",elevated:""},{default:i(()=>[t(B,{class:"text-primary-high d-flex align-center"},{default:i(()=>[t(b,{class:"mr-2",icon:"mdi-palette"}),e[11]||(e[11]=c("Display Settings ",-1))]),_:1}),t(I,null,{default:i(()=>[n("div",null,[e[14]||(e[14]=n("div",{class:"text-body-2 text-primary-medium mb-3"},"Theme",-1)),t(Ne,{modelValue:l.value.display.theme,"onUpdate:modelValue":e[0]||(e[0]=s=>l.value.display.theme=s),class:"w-100",color:"primary",divided:"",mandatory:"",variant:"outlined"},{default:i(()=>[t(x,{class:"flex-1-1",value:"dark"},{default:i(()=>[t(b,{class:"mr-2",icon:"mdi-weather-night"}),e[12]||(e[12]=c("Dark",-1))]),_:1}),t(x,{class:"flex-1-1",value:"light"},{default:i(()=>[t(b,{class:"mr-2",icon:"mdi-white-balance-sunny"}),e[13]||(e[13]=c("Light",-1))]),_:1})]),_:1},8,["modelValue"]),e[15]||(e[15]=n("div",{class:"text-caption text-secondary mt-3"},"Dashboard data refresh is fixed at every 5 seconds.",-1))])]),_:1})]),_:1}),t(U,{class:"mb-4"},{default:i(()=>[t(B,{class:"text-primary-high d-flex align-center"},{default:i(()=>[t(b,{class:"mr-2",icon:"mdi-bell"}),e[16]||(e[16]=c("Notifications",-1))]),_:1}),t(I,null,{default:i(()=>[t(W,{modelValue:l.value.notifications.update_available,"onUpdate:modelValue":e[1]||(e[1]=s=>l.value.notifications.update_available=s),class:"mb-4",color:"primary","hide-details":"",label:"Notify when updates are available"},null,8,["modelValue"]),t(W,{modelValue:l.value.notifications.installation_complete,"onUpdate:modelValue":e[2]||(e[2]=s=>l.value.notifications.installation_complete=s),color:"primary","hide-details":"",label:"Notify when installation completes"},null,8,["modelValue"])]),_:1})]),_:1}),t(U,null,{default:i(()=>[t(B,{class:"text-primary-high d-flex align-center"},{default:i(()=>[t(b,{class:"mr-2",icon:"mdi-wifi"}),e[17]||(e[17]=c("Wi-Fi Networks ",-1))]),_:1}),t(I,null,{default:i(()=>[n("div",He,[n("div",Le,[e[18]||(e[18]=c(" Connected network: ",-1)),n("strong",Oe,Te(V.value),1)]),t(x,{density:"compact",loading:C.value,"prepend-icon":"mdi-refresh",size:"small",variant:"outlined",onClick:A},{default:i(()=>[...e[19]||(e[19]=[c(" Scan nearby SSIDs ",-1)])]),_:1},8,["loading"])]),t(Re,{modelValue:r.value.ssid,"onUpdate:modelValue":e[3]||(e[3]=s=>r.value.ssid=s),class:"mb-3","item-title":"title","item-value":"value",items:D.value,label:"Nearby Wi-Fi SSID",placeholder:"Select a network",variant:"outlined"},null,8,["modelValue","items"]),t(j,{modelValue:r.value.password,"onUpdate:modelValue":e[4]||(e[4]=s=>r.value.password=s),"append-inner-icon":g.value?"mdi-eye-off":"mdi-eye",class:"mb-4",label:"Wi-Fi password",placeholder:"Enter network password",type:g.value?"text":"password",variant:"outlined","onClick:appendInner":e[5]||(e[5]=s=>g.value=!g.value)},null,8,["modelValue","append-inner-icon","type"]),t(x,{block:"",color:"primary",disabled:!r.value.ssid||!r.value.password,loading:F.value,"prepend-icon":"mdi-wifi-plus",onClick:M},{default:i(()=>[...e[20]||(e[20]=[c(" Connect to Network ",-1)])]),_:1},8,["disabled","loading"])]),_:1})]),_:1})]),_:1}),t(te,{cols:"12",lg:"6"},{default:i(()=>[t(U,{elevated:""},{default:i(()=>[t(B,{class:"text-primary-high d-flex align-center"},{default:i(()=>[t(b,{class:"mr-2",icon:"mdi-update"}),e[21]||(e[21]=c("Auto-Update Settings",-1))]),_:1}),t(I,null,{default:i(()=>[t(W,{modelValue:l.value.auto_update.enabled,"onUpdate:modelValue":e[6]||(e[6]=s=>l.value.auto_update.enabled=s),class:"mb-6",color:"primary","hide-details":"",label:"Enable automatic update checks"},null,8,["modelValue"]),l.value.auto_update.enabled?(P(),O("div",je,[n("div",Je,[e[22]||(e[22]=n("div",{class:"text-body-2 text-primary-medium mb-3"},"Check Interval (hours)",-1)),t(j,{modelValue:l.value.auto_update.check_interval_hours,"onUpdate:modelValue":e[7]||(e[7]=s=>l.value.auto_update.check_interval_hours=s),modelModifiers:{number:!0},density:"comfortable",hint:"How often to check for updates",min:1,"persistent-hint":"",type:"number",variant:"outlined"},null,8,["modelValue"])]),n("div",qe,[e[23]||(e[23]=n("div",{class:"text-body-2 text-primary-medium mb-3"},"Preferred Check Time",-1)),t(j,{modelValue:l.value.auto_update.check_time,"onUpdate:modelValue":e[8]||(e[8]=s=>l.value.auto_update.check_time=s),density:"comfortable",hint:"Time of day to check for updates (HH:MM)","persistent-hint":"",type:"time",variant:"outlined"},null,8,["modelValue"])]),n("div",null,[t(W,{modelValue:l.value.auto_update.auto_install,"onUpdate:modelValue":e[9]||(e[9]=s=>l.value.auto_update.auto_install=s),color:"warning","hide-details":""},{label:i(()=>[...e[24]||(e[24]=[n("div",null,[n("div",{class:"text-body-2"},"Automatically install updates"),n("div",{class:"text-caption text-secondary"},"Updates will be installed without confirmation")],-1)])]),_:1},8,["modelValue"]),l.value.auto_update.auto_install?(P(),K(Me,{key:0,class:"mt-3",density:"compact",icon:"mdi-alert",type:"warning",variant:"tonal"},{default:i(()=>[...e[25]||(e[25]=[n("div",{class:"text-caption"},"Warning: Updates will be installed automatically without your confirmation.",-1)])]),_:1})):Q("",!0)])])):Q("",!0)]),_:1})]),_:1})]),_:1})]),_:1}),t(U,{class:"mt-6"},{default:i(()=>[t(I,null,{default:i(()=>[n("div",Ge,[t(x,{color:"error",disabled:m.value,loading:h.value,"prepend-icon":"mdi-restore",variant:"outlined",onClick:$},{default:i(()=>[...e[26]||(e[26]=[c("Reset to Defaults",-1)])]),_:1},8,["disabled","loading"]),t(x,{color:"primary",disabled:h.value||!R.value,loading:m.value,"prepend-icon":"mdi-content-save",size:"large",onClick:N},{default:i(()=>[...e[27]||(e[27]=[c("Save Settings",-1)])]),_:1},8,["disabled","loading"])])]),_:1})]),_:1})]))]),_:1}))}},lt=he(Xe,[["__scopeId","data-v-0321d0fe"]]);export{lt as default};
