import{_ as N,B as j,o as L,a as U,c as v,w as e,y as m,C as D,r as I,u as F,D as q,E as G,G as H,d as c,j as O,e as r,i as W,f as s,n as J,m as V,H as K,I as C,h as g,t as B}from"./index-CKh2z7Xl.js";import{V as Q,_ as A}from"./VContainer-BY01WYsX.js";import{_ as X}from"./StatusBadge-Du4jXtwf.js";import{V as Y,a as k}from"./VRow-Cd8JKBFL.js";import{V as M}from"./VChip-qdZfEUql.js";const Z={key:0,class:"mb-6"},tt={class:"d-flex justify-space-between align-start mb-4"},at={class:"text-body-2 text-secondary mt-1"},et={class:"d-flex align-center justify-space-between mb-3"},st={__name:"apps",setup(nt){const h=q(),$=G(),{error:R}=F(),o=I(null),l=I(null);let i=null,u=null;const p=m(()=>h.path==="/apps"),w=m(()=>{if(!o.value?.installed)return"Not Installed";const a=y(l.value?.status||l.value?.event);if(a)return a;if(l.value?.connected)return l.value?.running?"Running":"Stopped";const t=String(o.value?.status||""),n=y(t);return n||(o.value?.active?"Running":"Stopped")}),P=m(()=>{const a=w.value.toLowerCase();return a==="running"?"success":a==="starting"?"info":a==="calibrating"?"warning":"neutral"});function T(a){const t=String(a?.message||"").toLowerCase();return a?.status===404||a?.status===502||a?.status===503||t.includes("not running")||t.includes("not installed")||t.includes("not found")}function y(a){const t=String(a||"").toLowerCase();return t?t.includes("start")?"Starting":t.includes("calibrat")?"Calibrating":t.includes("run")?"Running":t.includes("stop")?"Stopped":"":""}function z(a){const t=window.location.protocol==="https:"?"https":"http",n="/api/state",S=n.startsWith("/")?n:`/${n}`;return`${t}://${a}:3180${S}`}async function _(){const t=z("cdo-vertex.local");try{const n=await fetch(t,{cache:"no-store"});if(!n.ok)throw new Error("Board Manager request failed");l.value=await n.json()}catch{l.value=null}}function E(){i||(_(),i=setInterval(_,1e3))}function d(){i&&(clearInterval(i),i=null)}async function b(){try{const a=await D();return o.value=a.data,!!o.value?.installed}catch(a){return T(a)?(o.value={installed:!1,active:!1},f(),d(),!1):(R("Failed to load app status: "+a.message),!1)}}async function x(){if(u)return;if(!await b()){d();return}E(),u=setInterval(b,1e3)}function f(){u&&(clearInterval(u),u=null)}return j(()=>h.path,async a=>{a==="/apps"?await x():(f(),d())}),L(async()=>{p.value&&await x()}),U(()=>{f(),d()}),(a,t)=>{const n=H("router-view");return c(),v(Q,{class:"pa-4 pa-md-6",fluid:""},{default:e(()=>[p.value?(c(),O("div",Z,[...t[1]||(t[1]=[r("h1",{class:"text-h4 text-md-h3 text-primary-high font-weight-bold mb-1"},"Apps",-1),r("p",{class:"text-body-2 text-secondary"},"Installed applications and runtime status",-1)])])):W("",!0),p.value?(c(),v(Y,{key:2},{default:e(()=>[s(k,{cols:"12",lg:"4",md:"6"},{default:e(()=>[s(A,{class:"h-100 hoverable-card app-card",onClick:t[0]||(t[0]=S=>J($).push("/apps/autodarts"))},{default:e(()=>[s(V,null,{default:e(()=>[r("div",tt,[s(K,{color:"primary",size:"48",variant:"tonal"},{default:e(()=>[s(C,{icon:"mdi-bullseye-arrow"})]),_:1}),s(X,{variant:P.value},{default:e(()=>[g(B(w.value),1)]),_:1},8,["variant"])]),t[3]||(t[3]=r("div",{class:"text-h6 text-primary-high font-weight-bold"},"Autodarts",-1)),r("div",at,B(o.value?.installed?`Version ${o.value?.version||"n/a"}`:"Install to enable smart dartboard scoring."),1),s(M,{class:"mt-4",color:"info","prepend-icon":"mdi-cog",size:"small",variant:"tonal"},{default:e(()=>[...t[2]||(t[2]=[g(" Tap for controls ",-1)])]),_:1})]),_:1})]),_:1})]),_:1}),s(k,{cols:"12",lg:"4",md:"6"},{default:e(()=>[s(A,{class:"h-100"},{default:e(()=>[s(V,null,{default:e(()=>[r("div",et,[t[4]||(t[4]=r("div",{class:"text-h6 text-primary-high"},"Future App Slots",-1)),s(C,{color:"secondary",icon:"mdi-download-circle-outline"})]),t[6]||(t[6]=r("div",{class:"text-body-2 text-secondary mb-3"}," This area is ready for downloadable apps in upcoming releases. ",-1)),s(M,{color:"secondary",size:"small",variant:"outlined"},{default:e(()=>[...t[5]||(t[5]=[g("Coming Soon",-1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):(c(),v(n,{key:1}))]),_:1})}}},dt=N(st,[["__scopeId","data-v-77add108"]]);export{dt as default};
