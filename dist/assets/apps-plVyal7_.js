import{_ as j,q as E,o as L,a as U,c as v,w as e,p as m,s as q,r as V,u as F,v as D,x as O,y as W,d as c,h as G,e as o,j as H,f as s,z as J,A as I,l as g,t as C}from"./index-BsA5uyE-.js";import{b as K,_ as B,V as A,c as Q}from"./VContainer-CoJXfR-4.js";import{_ as X}from"./StatusBadge-C3FUqbJr.js";import{V as Y,a as k}from"./VRow-CMnZ5MN3.js";import{V as M}from"./VChip-GHPtzN8R.js";const Z={key:0,class:"mb-6"},tt={class:"d-flex justify-space-between align-start mb-4"},at={class:"text-body-2 text-secondary mt-1"},et={class:"d-flex align-center justify-space-between mb-3"},st={__name:"apps",setup(nt){const h=D(),$=O(),{error:R}=F(),r=V(null),l=V(null);let i=null,u=null;const p=m(()=>h.path==="/apps"),w=m(()=>{if(!r.value?.installed)return"Not Installed";const a=b(l.value?.status||l.value?.event);if(a)return a;if(l.value?.connected)return l.value?.running?"Running":"Stopped";const t=String(r.value?.status||""),n=b(t);return n||(r.value?.active?"Running":"Stopped")}),z=m(()=>{const a=w.value.toLowerCase();return a==="running"?"success":a==="starting"?"info":a==="calibrating"?"warning":"neutral"});function P(a){const t=String(a?.message||"").toLowerCase();return a?.status===404||a?.status===503||t.includes("not running")||t.includes("not installed")||t.includes("not found")}function b(a){const t=String(a||"").toLowerCase();return t?t.includes("start")?"Starting":t.includes("calibrat")?"Calibrating":t.includes("run")?"Running":t.includes("stop")?"Stopped":"":""}function T(a){const t=window.location.protocol==="https:"?"https":"http",n="/api/state",S=n.startsWith("/")?n:`/${n}`;return`${t}://${a}:3180${S}`}async function y(){const t=T("cdo-vertex.local");try{const n=await fetch(t,{cache:"no-store"});if(!n.ok)throw new Error("Board Manager request failed");l.value=await n.json()}catch{l.value=null}}function N(){i||(y(),i=setInterval(y,1e3))}function d(){i&&(clearInterval(i),i=null)}async function _(){try{const a=await q();return r.value=a.data,!!r.value?.installed}catch(a){return P(a)?(r.value={installed:!1,active:!1},f(),d(),!1):(R("Failed to load app status: "+a.message),!1)}}async function x(){if(u)return;if(!await _()){d();return}N(),u=setInterval(_,1e3)}function f(){u&&(clearInterval(u),u=null)}return E(()=>h.path,async a=>{a==="/apps"?await x():(f(),d())}),L(async()=>{p.value&&await x()}),U(()=>{f(),d()}),(a,t)=>{const n=W("router-view");return c(),v(K,{class:"pa-4 pa-md-6",fluid:""},{default:e(()=>[p.value?(c(),G("div",Z,[...t[1]||(t[1]=[o("h1",{class:"text-h4 text-md-h3 text-primary-high font-weight-bold mb-1"},"Apps",-1),o("p",{class:"text-body-2 text-secondary"},"Installed applications and runtime status",-1)])])):H("",!0),p.value?(c(),v(Y,{key:2},{default:e(()=>[s(k,{cols:"12",lg:"4",md:"6"},{default:e(()=>[s(B,{class:"h-100 hoverable-card app-card",onClick:t[0]||(t[0]=S=>J($).push("/apps/autodarts"))},{default:e(()=>[s(A,null,{default:e(()=>[o("div",tt,[s(Q,{color:"primary",size:"48",variant:"tonal"},{default:e(()=>[s(I,{icon:"mdi-bullseye-arrow"})]),_:1}),s(X,{variant:z.value},{default:e(()=>[g(C(w.value),1)]),_:1},8,["variant"])]),t[3]||(t[3]=o("div",{class:"text-h6 text-primary-high font-weight-bold"},"Autodarts",-1)),o("div",at,C(r.value?.installed?`Version ${r.value?.version||"n/a"}`:"Install to enable smart dartboard scoring."),1),s(M,{class:"mt-4",color:"info","prepend-icon":"mdi-cog",size:"small",variant:"tonal"},{default:e(()=>[...t[2]||(t[2]=[g(" Tap for controls ",-1)])]),_:1})]),_:1})]),_:1})]),_:1}),s(k,{cols:"12",lg:"4",md:"6"},{default:e(()=>[s(B,{class:"h-100"},{default:e(()=>[s(A,null,{default:e(()=>[o("div",et,[t[4]||(t[4]=o("div",{class:"text-h6 text-primary-high"},"Future App Slots",-1)),s(I,{color:"secondary",icon:"mdi-download-circle-outline"})]),t[6]||(t[6]=o("div",{class:"text-body-2 text-secondary mb-3"}," This area is ready for downloadable apps in upcoming releases. ",-1)),s(M,{color:"secondary",size:"small",variant:"outlined"},{default:e(()=>[...t[5]||(t[5]=[g("Coming Soon",-1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):(c(),v(n,{key:1}))]),_:1})}}},dt=j(st,[["__scopeId","data-v-065f7fbb"]]);export{dt as default};
